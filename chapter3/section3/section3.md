<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script>
# 正确性

为了达到正确性，在拜占庭式的faulty节点的最大数量低于某一个阀值的条件得到满足时，必须证明欺诈交易不可能在共识期间得到确认。RPCA正确性的证明是直接的：因为一个交易只有在80%以上的UNL同意的情况下才被批准，只要80%以上的UNL是诚实的，那么欺诈交易就不会被批准。因此，对于网络中拥有n个Server节点的UNL，共识协议可以保证正确性得到满足，只要：
$$f \leq (n - 1) / 5 \qquad (1)$$
其中f是拜占庭faulty节点的数量。事实上，即使在有\\((n−1)/5 + 1\\)拜占庭式faulty节点的情况下，正确性仍然在技术上得到保证。共识将失败，但仍然不会批准欺诈交易。事实上，欺诈交易需要\\((4n + 1)/5\\)拜占庭式的faulty节点才能被确认。我们称这个为弱正确性界限，之前那个为强正确性界限。
还应指出，并非所有欺诈交易都构成威胁，即使欺诈交易在同步期间得到确认。比如用户试图在两笔交易中花费双倍的资金，即使这两笔交易都在同步过程中得到确认，在第一笔交易被应用之后，第二笔交易将失败，因为剩余资金不足。

让我们进行一些另类的分析，假设任何Server节点决定密谋并加入一个邪恶集团的概率都是\\(p_c\\)。在此基础上，\\(p\*\\)代表分布式支付系统达成正确性的概率：

$$p* = \sum_{k=1}^{\frac{n - 1}5} p_c^i (1 - p_c)^{n-i} \qquad (2)$$

这一概率代表了在给定\\(p_c\\)的情况下，邪恶集团的规模维持在最大限度拜占庭式faulty节点数量以下的可能性。由于上述公式是二项分布式，\\(p_c\\)值大于20%将导致卡特尔集团中节点的数量大于20%的预期，从而阻碍共识过程。在实践中，UNL是为了尽量减少\\(p_c\\)值去选择的，而不是随机选择的。由于节点不是匿名的，而且是密码学上可识别的，所以从各种不同的大陆、国家、产业、意识形态中选择的UNL，其\\(p_c\\)值会远低于20%。即使UNL有一个相对较大的\\(p_c\\)值，比如说15%，即便在UNL中只有200个节点，其正确性的概率也是非常高的，达到了97.8%。

下图描述了不同\\(p_c\\)值的UNL，其阻塞同步过程的概率随着UNL中节点数量的增长而变化的函数的图形表示。
![younghz的Markdown库](/asserts/1.bmp "图1")

<strong align = "center">图1.UNL的规模和邪恶集团阻挠一致性达成的概率的关系函数，不同\\(p_c\\)的值代表UNL的任何成员决定与他人勾结密谋的可能性。在这里，较低的数值表明一致性过程成功的可能性更高。</strong>

注意，这里的垂直轴表示邪恶集团阻挠同步过程的可能性，因此数值越低，表明同步过程获得成功的可能性更大。如图所示，即使\\(p_c\\)值高达10%，随着UNL中节点数量增长到超过100个节点，达成共识的阻力很快就变得微不足道了。